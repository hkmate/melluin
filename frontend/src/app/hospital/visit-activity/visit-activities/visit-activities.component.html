<div class="activities-info">

    <mat-accordion [multi]="true">
        <mat-expansion-panel *ngIf="permissions.has(Permission.canReadChild)">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    {{ 'HospitalVisit.Activities.Children' | translate }}
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="children-info">
                <app-children-list-manager
                        [editEnabled]="editEnabled"
                        [needParentInfo]="true"
                        [visitDate]="visitDate"
                        [children]="children"
                        (childrenChange)="childrenListChanged($event)"></app-children-list-manager>
            </div>
        </mat-expansion-panel>

        <mat-expansion-panel *ngIf="permissions.has(Permission.canReadActivity)">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    {{ 'HospitalVisit.Activities.Activities' | translate }}
                </mat-panel-title>
            </mat-expansion-panel-header>
            <app-visit-activity-manager [visitId]="visit.id"
                                        [activities]="activities"
                                        [children]="children"
                                        [editEnabled]="editEnabled && permissions.has(Permission.canCreateActivity)">
            </app-visit-activity-manager>
        </mat-expansion-panel>

        <mat-expansion-panel *ngIf="editEnabled && permissions.has(Permission.canReadDepBox)">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    {{ 'HospitalVisit.Activities.BoxInfo' | translate }}
                </mat-panel-title>
            </mat-expansion-panel-header>
            <app-optional-box-info-creator *ngIf="permissions.has(Permission.canWriteDepBox)"
                                           [departmentId]="visit.department.id"
                                           [visitId]="visit.id"
                                           (itemAdded)="boxStatusAdded($event)">
            </app-optional-box-info-creator>
            <div *ngFor="let boxInfo of boxInfoList" class="box-info">
                <app-department-box-info [boxStatus]="boxInfo"></app-department-box-info>
            </div>
        </mat-expansion-panel>
    </mat-accordion>

</div>
